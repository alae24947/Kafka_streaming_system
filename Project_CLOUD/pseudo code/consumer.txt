INITIALIZE Kafka consumer subscribed to topic "orders"
INITIALIZE MongoDB connection
INITIALIZE collections:
    large_orders
    stats
    invalid_orders

INITIALIZE aggregation variables:
    count ← 0
    total_price ← 0
    min_price ← +∞
    max_price ← 0

DEFINE required fields list

FUNCTION is_valid_order(order):
    CHECK presence of required fields
    CHECK data types of fields
    CHECK value ranges
    CHECK timestamp format
    RETURN true if all checks pass, else false

FOR each message received from Kafka DO
    PARSE message JSON into order object

    IF order is NOT valid THEN
        STORE order in invalid_orders collection
        CONTINUE to next message
    END IF

    IF order.price > 1000 THEN
        STORE order in large_orders collection

        UPDATE aggregations:
            count ← count + 1
            total_price ← total_price + order.price
            min_price ← min(min_price, order.price)
            max_price ← max(max_price, order.price)
            average_price ← total_price / count

        STORE updated statistics in stats collection
    ELSE
        IGNORE order
    END IF
END FOR
